import{R as D,Q as g}from"./QBtn.13c9c28e.js";import{Q as L,a as C}from"./QHeader.97884fe0.js";import{Q as q}from"./QSpace.35362652.js";import{Q}from"./QAvatar.c0f617fa.js";import{Q as A}from"./QToolbar.df85c749.js";import{Q as h}from"./QIcon.183e8fa8.js";import{Q as o,a as m}from"./QItem.fbffd16a.js";import{Q as i}from"./QItemLabel.6ae2f278.js";import{Q as B}from"./QList.f1e6330b.js";import{Q as M}from"./QDrawer.120c5101.js";import{Q as O,a as V}from"./QLayout.495b6a5b.js";import{j as S,_,k as u,v as p,m as t,d as e,s as $,t as n,u as c,l as y,F as U,q as N,I as j,p as v,O as x}from"./index.d4268c22.js";import{a as w}from"./axios.ab682c6b.js";import{l as z}from"./index.5c50d63d.js";import"./QSpinner.54ae2b08.js";import"./use-size.fd56a178.js";import"./dom.e83c55c8.js";import"./use-router-link.7ecbec49.js";import"./vm.bd5b438f.js";import"./render.d29caea9.js";import"./QResizeObserver.85bfe230.js";import"./use-dark.57e59592.js";import"./use-prevent-scroll.61e86cc2.js";import"./scroll.8fea1542.js";import"./use-model-toggle.833413c1.js";import"./use-timeout.d19f8495.js";import"./touch.9135741d.js";import"./selection.34842c42.js";import"./format.054b8074.js";const T=S({name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:"#"},icon:{type:String,default:""}}});function F(a,r,l,k,d,f){return u(),p(m,{clickable:"",tag:"a",target:"_blank",href:a.link},{default:t(()=>[a.icon?(u(),p(o,{key:0,avatar:""},{default:t(()=>[e(h,{name:a.icon},null,8,["name"])]),_:1})):$("",!0),e(o,null,{default:t(()=>[e(i,null,{default:t(()=>[n(c(a.title),1)]),_:1}),e(i,{caption:""},{default:t(()=>[n(c(a.caption),1)]),_:1})]),_:1})]),_:1},8,["href"])}var P=_(T,[["render",F]]);const R=S({name:"Messages",setup(){return{messages:[{id:5,name:"Pratik Patel",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://avatars2.githubusercontent.com/u/34883558?s=400&v=4",time:"10:42 PM"},{id:6,name:"Winfield Stapforth",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://cdn.quasar.dev/img/avatar6.jpg",time:"11:17 AM"},{id:1,name:"Boy",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://cdn.quasar.dev/img/boy-avatar.png",time:"5:17 AM"},{id:2,name:"Jeff Galbraith",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://cdn.quasar.dev/team/jeff_galbraith.jpg",time:"5:17 AM"},{id:3,name:"Razvan Stoenescu",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://cdn.quasar.dev/team/razvan_stoenescu.jpeg",time:"5:17 AM"}]}}}),E=["src"];function J(a,r,l,k,d,f){return u(),y("div",null,[(u(!0),y(U,null,N(a.messages,s=>j((u(),p(m,{style:{"max-width":"420px"},key:s.id,clickable:""},{default:t(()=>[e(o,{avatar:""},{default:t(()=>[e(Q,null,{default:t(()=>[v("img",{src:s.avatar},null,8,E)]),_:2},1024)]),_:2},1024),e(o,null,{default:t(()=>[e(i,null,{default:t(()=>[n(c(s.name),1)]),_:2},1024),e(i,{caption:"",lines:"1"},{default:t(()=>[n(c(s.msg),1)]),_:2},1024)]),_:2},1024),e(o,{side:""},{default:t(()=>[n(c(s.time),1)]),_:2},1024)]),_:2},1024)),[[D]])),128))])}var G=_(R,[["render",J]]);const I="https://backend.ppark.online/api",H={name:"MainLayout",components:{EssentialLink:P,Messages:G},data(){return{leftDrawerOpen:!1,first_name:"",user:null,pollingInterval:null,isLoading:!0}},computed:{drawerStatus(){return this.leftDrawerOpen?"Open":"Closed"}},created(){const a="http://93.127.167.211:5500";this.socket=z(a),this.socket.on("receiverTriggerness",(r,l)=>{r=="AutomaticLogoutWorkerApplicant"&&this.handleLogout()})},methods:{refreshrouter(){this.$router.go()},toggleLeftDrawer(){this.leftDrawerOpen=!this.leftDrawerOpen},async handleLogout(){try{const a=JSON.parse(localStorage.getItem("user"));let r=null;if(a&&a.account_type===5?r=localStorage.getItem("access_token_employer"):a&&a.account_type===6&&(r=localStorage.getItem("access_token_applicant")),r){const l=await w.post(`${I}/logout`,null,{headers:{Authorization:`Bearer ${r}`}});l.data.message==="Successfully logged out"?(localStorage.removeItem("access_token_employer"),localStorage.removeItem("access_token_applicant"),localStorage.removeItem("user_data"),localStorage.removeItem("user"),this.$router.push("/login")):console.error("Unexpected logout response:",l.data)}}catch(a){console.error("Logout failed:",a)}},async fetchUserData(){try{const a=JSON.parse(localStorage.getItem("user"));let r=null;if(a&&a.account_type===5?(localStorage.removeItem("access_token_applicant"),r=localStorage.getItem("access_token_employer")):a&&a.account_type===6&&(localStorage.removeItem("access_token_employer"),r=localStorage.getItem("access_token_applicant")),r){const l=await w.get(`${I}/shortpolling`,{headers:{Authorization:`Bearer ${r}`}});this.user=l.data,this.first_name=this.user.first_name}}catch(a){console.error("Failed to fetch user data:",a),this.$router.push("/login")}finally{this.isLoading=!1}}},mounted(){this.fetchUserData()},beforeUnmount(){this.pollingInterval&&clearInterval(this.pollingInterval)}},W={class:"q-gutter-sm row items-center no-wrap"},K=v("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png"},null,-1);function X(a,r,l,k,d,f){const s=x("router-view");return u(),p(O,{view:"lHh Lpr lFf"},{default:t(()=>[e(C,{elevated:""},{default:t(()=>[e(A,null,{default:t(()=>[e(g,{flat:"",dense:"",round:"",onClick:f.toggleLeftDrawer,icon:"menu","aria-label":"Menu"},null,8,["onClick"]),e(L,null,{default:t(()=>[n(c(d.first_name),1)]),_:1}),e(q),v("div",W,[a.$q.screen.gt.sm?(u(),p(g,{key:0,round:"",dense:"",flat:"",color:"white",icon:a.$q.fullscreen.isActive?"fullscreen_exit":"fullscreen",onClick:r[0]||(r[0]=b=>a.$q.fullscreen.toggle())},null,8,["icon"])):$("",!0),e(g,{round:"",flat:""},{default:t(()=>[e(Q,{size:"26px"},{default:t(()=>[K]),_:1})]),_:1}),e(g,{round:"",dense:"",flat:"",color:"white",icon:"logout",onClick:f.handleLogout},null,8,["onClick"])])]),_:1})]),_:1}),e(M,{modelValue:d.leftDrawerOpen,"onUpdate:modelValue":r[1]||(r[1]=b=>d.leftDrawerOpen=b),"show-if-above":"",bordered:"",class:"bg-primary text-white"},{default:t(()=>[e(B,{pointers:""},{default:t(()=>[e(m,{clickable:"",tag:"a",href:"/global-chat",target:"_blank",rel:"noopener noreferrer"},{default:t(()=>[e(o,{avatar:""},{default:t(()=>[e(h,{name:"chat"})]),_:1}),e(o,null,{default:t(()=>[e(i,null,{default:t(()=>[n("Global Chat")]),_:1})]),_:1})]),_:1}),e(m,{clickable:"",tag:"a",href:"/records",target:"_blank",rel:"noopener noreferrer"},{default:t(()=>[e(o,{avatar:""},{default:t(()=>[e(h,{name:"table_chart"})]),_:1}),e(o,null,{default:t(()=>[e(i,null,{default:t(()=>[n("Records")]),_:1})]),_:1})]),_:1}),e(m,{to:"/","active-class":"q-item-no-link-highlighting"},{default:t(()=>[e(o,{avatar:""},{default:t(()=>[e(h,{name:"play_circle_filled"})]),_:1}),e(o,null,{default:t(()=>[e(i,null,{default:t(()=>[n("Video Cam")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(V,{class:"bg-grey-2"},{default:t(()=>[e(s)]),_:1})]),_:1})}var De=_(H,[["render",X]]);export{De as default};
