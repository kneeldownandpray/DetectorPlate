import{R as D,Q as f}from"./QBtn.6503b927.js";import{Q as L,a as q}from"./QHeader.ebd8e5ff.js";import{Q as C}from"./QSpace.cfb14d30.js";import{Q}from"./QAvatar.0f56a7ba.js";import{Q as A}from"./QToolbar.a05d6b61.js";import{Q as h}from"./QIcon.c3f0630e.js";import{Q as o,a as g}from"./QItem.0e72154d.js";import{Q as c}from"./QItemLabel.8cc1f1e2.js";import{Q as B}from"./QList.b595b344.js";import{Q as M}from"./QDrawer.720733dc.js";import{Q as O,a as V}from"./QLayout.e7ca0099.js";import{j as S,_,k as i,v as m,m as t,d as e,s as $,t as l,u,l as b,F as U,q as N,I as j,p as v,O as x}from"./index.ef86348d.js";import{a as w}from"./axios.ab682c6b.js";import"./QSpinner.61c3e8e6.js";import"./use-size.955305ef.js";import"./dom.a0618220.js";import"./use-router-link.5a2b0965.js";import"./vm.bd5b438f.js";import"./render.0fa28f0b.js";import"./QResizeObserver.ba6960a1.js";import"./use-dark.51648456.js";import"./use-prevent-scroll.ddadc635.js";import"./scroll.124b3ac8.js";import"./use-model-toggle.2da2574c.js";import"./use-timeout.e83c5089.js";import"./TouchPan.7c9688d3.js";import"./touch.9135741d.js";import"./selection.28dee7bf.js";import"./format.054b8074.js";import"./QScrollObserver.90f7054b.js";const z=S({name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:"#"},icon:{type:String,default:""}}});function T(a,r,n,k,d,p){return i(),m(g,{clickable:"",tag:"a",target:"_blank",href:a.link},{default:t(()=>[a.icon?(i(),m(o,{key:0,avatar:""},{default:t(()=>[e(h,{name:a.icon},null,8,["name"])]),_:1})):$("",!0),e(o,null,{default:t(()=>[e(c,null,{default:t(()=>[l(u(a.title),1)]),_:1}),e(c,{caption:""},{default:t(()=>[l(u(a.caption),1)]),_:1})]),_:1})]),_:1},8,["href"])}var F=_(z,[["render",T]]);const P=S({name:"Messages",setup(){return{messages:[{id:5,name:"Pratik Patel",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://avatars2.githubusercontent.com/u/34883558?s=400&v=4",time:"10:42 PM"},{id:6,name:"Winfield Stapforth",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://cdn.quasar.dev/img/avatar6.jpg",time:"11:17 AM"},{id:1,name:"Boy",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://cdn.quasar.dev/img/boy-avatar.png",time:"5:17 AM"},{id:2,name:"Jeff Galbraith",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://cdn.quasar.dev/team/jeff_galbraith.jpg",time:"5:17 AM"},{id:3,name:"Razvan Stoenescu",msg:` -- I'll be in your neighborhood doing errands this
            weekend. Do you want to grab brunch?`,avatar:"https://cdn.quasar.dev/team/razvan_stoenescu.jpeg",time:"5:17 AM"}]}}}),R=["src"];function E(a,r,n,k,d,p){return i(),b("div",null,[(i(!0),b(U,null,N(a.messages,s=>j((i(),m(g,{style:{"max-width":"420px"},key:s.id,clickable:""},{default:t(()=>[e(o,{avatar:""},{default:t(()=>[e(Q,null,{default:t(()=>[v("img",{src:s.avatar},null,8,R)]),_:2},1024)]),_:2},1024),e(o,null,{default:t(()=>[e(c,null,{default:t(()=>[l(u(s.name),1)]),_:2},1024),e(c,{caption:"",lines:"1"},{default:t(()=>[l(u(s.msg),1)]),_:2},1024)]),_:2},1024),e(o,{side:""},{default:t(()=>[l(u(s.time),1)]),_:2},1024)]),_:2},1024)),[[D]])),128))])}var J=_(P,[["render",E]]);const I="https://backend.parkease.online/api",H={name:"MainLayout",components:{EssentialLink:F,Messages:J},data(){return{leftDrawerOpen:!1,first_name:"",user:null,pollingInterval:null,isLoading:!0}},computed:{drawerStatus(){return this.leftDrawerOpen?"Open":"Closed"}},created(){const a="https://realtime.parkease.online";this.socket=io(a),this.socket.on("receiverTriggerness",(r,n)=>{r=="AutomaticLogoutWorkerApplicant"&&this.handleLogout()})},methods:{refreshrouter(){this.$router.go()},toggleLeftDrawer(){this.leftDrawerOpen=!this.leftDrawerOpen},async handleLogout(){try{const a=JSON.parse(localStorage.getItem("user"));let r=null;if(a&&a.account_type===5?r=localStorage.getItem("access_token_employer"):a&&a.account_type===6&&(r=localStorage.getItem("access_token_applicant")),r){const n=await w.post(`${I}/logout`,null,{headers:{Authorization:`Bearer ${r}`}});n.data.message==="Successfully logged out"?(localStorage.removeItem("access_token_employer"),localStorage.removeItem("access_token_applicant"),localStorage.removeItem("user_data"),localStorage.removeItem("user"),this.$router.push("/login")):console.error("Unexpected logout response:",n.data)}}catch(a){console.error("Logout failed:",a)}},async fetchUserData(){try{const a=JSON.parse(localStorage.getItem("user"));let r=null;if(a&&a.account_type===5?(localStorage.removeItem("access_token_applicant"),r=localStorage.getItem("access_token_employer")):a&&a.account_type===6&&(localStorage.removeItem("access_token_employer"),r=localStorage.getItem("access_token_applicant")),r){const n=await w.get(`${I}/shortpolling`,{headers:{Authorization:`Bearer ${r}`}});this.user=n.data,this.first_name=this.user.first_name}}catch(a){console.error("Failed to fetch user data:",a),this.$router.push("/login")}finally{this.isLoading=!1}}},mounted(){this.fetchUserData()},beforeUnmount(){this.pollingInterval&&clearInterval(this.pollingInterval)}},W={class:"q-gutter-sm row items-center no-wrap"},G=v("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png"},null,-1);function K(a,r,n,k,d,p){const s=x("router-view");return i(),m(O,{view:"lHh Lpr lFf"},{default:t(()=>[e(q,{elevated:""},{default:t(()=>[e(A,null,{default:t(()=>[e(f,{flat:"",dense:"",round:"",onClick:p.toggleLeftDrawer,icon:"menu","aria-label":"Menu"},null,8,["onClick"]),e(L,null,{default:t(()=>[l(u(d.first_name),1)]),_:1}),e(C),v("div",W,[a.$q.screen.gt.sm?(i(),m(f,{key:0,round:"",dense:"",flat:"",color:"white",icon:a.$q.fullscreen.isActive?"fullscreen_exit":"fullscreen",onClick:r[0]||(r[0]=y=>a.$q.fullscreen.toggle())},null,8,["icon"])):$("",!0),e(f,{round:"",flat:""},{default:t(()=>[e(Q,{size:"26px"},{default:t(()=>[G]),_:1})]),_:1}),e(f,{round:"",dense:"",flat:"",color:"white",icon:"logout",onClick:p.handleLogout},null,8,["onClick"])])]),_:1})]),_:1}),e(M,{modelValue:d.leftDrawerOpen,"onUpdate:modelValue":r[1]||(r[1]=y=>d.leftDrawerOpen=y),"show-if-above":"",bordered:"",class:"bg-primary text-white"},{default:t(()=>[e(B,{pointers:""},{default:t(()=>[e(g,{clickable:"",tag:"a",href:"/records",target:"_blank",rel:"noopener noreferrer"},{default:t(()=>[e(o,{avatar:""},{default:t(()=>[e(h,{name:"table_chart"})]),_:1}),e(o,null,{default:t(()=>[e(c,null,{default:t(()=>[l("Records")]),_:1})]),_:1})]),_:1}),e(g,{to:"/","active-class":"q-item-no-link-highlighting"},{default:t(()=>[e(o,{avatar:""},{default:t(()=>[e(h,{name:"play_circle_filled"})]),_:1}),e(o,null,{default:t(()=>[e(c,null,{default:t(()=>[l("Video Cam")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(V,{class:"bg-grey-2"},{default:t(()=>[e(s)]),_:1})]),_:1})}var De=_(H,[["render",K]]);export{De as default};
