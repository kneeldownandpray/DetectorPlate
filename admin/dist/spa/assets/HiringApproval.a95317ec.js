import{Q as V}from"./QIcon.bb9750ae.js";import{Q as s}from"./QBtn.e3ba8fe5.js";import{Q as n}from"./QCardSection.a5303736.js";import{Q}from"./QSeparator.42367e68.js";import{Q as d}from"./QTd.14a02cb5.js";import{Q as P}from"./QTable.95eb64b4.js";import{Q as $}from"./QCardActions.ab1a3fd6.js";import{Q as h}from"./QCard.e1b4f547.js";import{Q as b}from"./QDialog.d2ec560c.js";import{Q as j}from"./QPagination.a5839286.js";import{Q as C}from"./QSelect.7fc8bd9c.js";import{Q as D}from"./QPage.a4ebaaa8.js";import{a as m}from"./axios.ab682c6b.js";import{_ as I,j as q,k as i,v as p,m as l,d as t,p as r,t as k,u as c,s as v,l as g,F as H,q as _,au as R,av as F}from"./index.631e4989.js";import"./use-size.cb14fd9c.js";import"./render.86f80e41.js";import"./QSpinner.b32ed815.js";import"./dom.743d1640.js";import"./use-router-link.6338664c.js";import"./vm.bd5b438f.js";import"./use-dark.94823b81.js";import"./QList.5dcbacd3.js";import"./QMarkupTable.88c0e097.js";import"./scroll.5d898aa6.js";import"./QCheckbox.71e3c128.js";import"./private.use-form.81eb29f1.js";import"./use-prevent-scroll.71085d3e.js";import"./use-timeout.081b347b.js";import"./use-tick.dfdf9b07.js";import"./use-portal.0a348834.js";import"./focus-manager.7cc6c8df.js";import"./QInput.981afcd1.js";import"./use-key-composition.aa95e8e5.js";import"./use-id.10a13483.js";import"./uid.937d8ee7.js";import"./format.2cae61da.js";import"./QChip.e5d8ec81.js";import"./QItem.439b04aa.js";import"./QItemLabel.30bae559.js";import"./position-engine.6ae81e1d.js";import"./selection.292370fb.js";import"./rtl.276c3f1b.js";const u="https://backend.parkease.online/api",N=q({name:"AdminHiring",data(){return{dialogVisible:!1,interestedDialogVisible:!1,actionType:"",interestedEmployers:[],approvalRows:[],hiredRows:[],socket:null,deleteDialog:!1,columns:[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"full_name",label:"Employer Full Name",align:"left",field:"full_name",sortable:!0},{name:"applicant_full_name",label:"Applicant Full Name",align:"left",field:"applicant_full_name",sortable:!0},{name:"profession",label:"Profession",align:"left",field:e=>e.applicant.resume?e.applicant.resume.profession:"N/A",sortable:!0},{name:"action",label:"Actions",align:"center",field:"action"}],pagination:{rowsPerPage:10,page:1},rowsPerPageOptions:[5,10],totalPages:0,approvalMaxPages:1,hiredMaxPages:1,selectedTransactionId:null,loading:!1,detailsDialog:!1,rejectedOrApproved:!0}},methods:{toggleForRejectedAndApproved(){this.rejectedOrApproved=!this.rejectedOrApproved},async fetchApprovals(){this.loading=!0;try{const e=localStorage.getItem("access_token"),{data:o}=await m.get(`${u}/display-hiring-approval`,{headers:{Authorization:`Bearer ${e}`},params:{page:this.pagination.page,perPage:this.pagination.rowsPerPage}});this.approvalRows=o.data,this.approvalMaxPages=o.last_page}catch(e){console.error("Error fetching approvals:",e)}finally{this.loading=!1}},async fetchHired(){this.loading=!0;try{const e=localStorage.getItem("access_token"),{data:o}=await m.get(`${u}/display-rejected`,{headers:{Authorization:`Bearer ${e}`},params:{page:this.pagination.page,perPage:this.pagination.rowsPerPage}});this.hiredRows=o.data,this.hiredMaxPages=o.last_page}catch(e){console.error("Error fetching hired applicants:",e)}finally{this.loading=!1}},checkInterested(e,o){this.$route.params.employerId;const y=localStorage.getItem("access_token");m.get(`${u}/check-interested/${e.applicant.id}/${e.employer.id}`,{headers:{Authorization:`Bearer ${y}`}}).then(f=>{f.data.status?(this.actionType=o,this.dialogVisible=!0):(this.interestedEmployers=f.data.interested_employers,this.interestedDialogVisible=!0),this.selectedTransactionId=e.id}).catch(f=>{console.error("Error checking interested employers:",f)})},showConfirmationDialog(){this.dialogVisible=!0,this.interestedDialogVisible=!1},proceedWithAction(){this.approveHiring(this.selectedTransactionId),this.dialogVisible=!1},async approveHiring(e){try{const o=localStorage.getItem("access_token");await m.put(`${u}/hire/${e}/approve`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error approving hire:",o)}},async restoreHiring(e){try{const o=localStorage.getItem("access_token");await m.put(`${u}/hire/${e}/restore`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error approving hire:",o)}},async rejectHiring(e){try{const o=localStorage.getItem("access_token");await m.put(`${u}/hire/${e}/rejected`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error rejecting hire:",o)}},formatFullName(e){return`${e.first_name} ${e.middle_name} ${e.last_name}`.trim()},openDetailsModal(e){this.detailsDialog=!0}},created(){const e="https://realtime.parkease.online";this.socket=io(e),this.socket.on("receiverTriggerness",(o,y)=>{o=="TriggerHiredApprovalPolling"&&(this.fetchApprovals(),this.fetchHired())})},mounted(){this.fetchApprovals(),this.fetchHired()}}),w=e=>(R("data-v-49810729"),e=e(),F(),e),B={class:"text-h6 margin-mobile-rr3"},S={style:{display:"flex","justify-content":"flex-end"}},U={class:"text-green-600 font-semibold"},E={class:"text-blue-600 font-semibold"},O={class:"row items-center"},T=w(()=>r("div",null,[r("h4",{class:"q-mb-sm"},"Warning"),r("p",null,"Note: Other employers are also interested. Would you like to reject them?")],-1)),z={key:0},M={key:1},W=w(()=>r("p",null,"No other employers are interested in this worker.",-1)),L={key:1,style:{display:"flex","justify-content":"space-between",padding:"10px"}},Y={class:"text-green-600 font-semibold"},G={class:"text-blue-600 font-semibold"},J={key:3,style:{display:"flex","justify-content":"space-between",padding:"10px"}},K=w(()=>r("div",{class:"text-h6"},"Applicant Details",-1));function X(e,o,y,f,Z,x){return i(),p(D,{padding:""},{default:l(()=>[t(h,{class:"no-shadow",bordered:""},{default:l(()=>[t(n,{class:"header-format-w header-mobile-res",style:{display:"flex","justify-content":"space-between"}},{default:l(()=>[r("div",B,[t(V,{name:"supervisor_account",size:"25px",class:"q-mr-sm"}),k(" Hiring Approval ")]),r("div",S,[e.rejectedOrApproved?(i(),p(s,{key:0,label:"Pending Approvals ",color:"white","text-color":"black",onClick:o[0]||(o[0]=a=>e.toggleForRejectedAndApproved()),class:"q-mr-sm"})):(i(),p(s,{key:1,label:"Pending Approvals ",color:"white","text-color":"white",onClick:o[1]||(o[1]=a=>e.toggleForRejectedAndApproved()),class:"q-mr-sm",flat:""})),e.rejectedOrApproved?(i(),p(s,{key:2,label:"Rejected Approvals",color:"white",onClick:o[2]||(o[2]=a=>e.toggleForRejectedAndApproved()),flat:""})):(i(),p(s,{key:3,label:"Rejected Approvals",color:"white","text-color":"black",onClick:o[3]||(o[3]=a=>e.toggleForRejectedAndApproved())}))])]),_:1}),t(Q),t(n,{class:"q-pa-none"},{default:l(()=>[e.rejectedOrApproved?(i(),p(P,{key:0,square:"",class:"no-shadow",title:"Pending Approvals",rows:e.approvalRows,columns:e.columns,"row-key":"id",pagination:e.pagination,"hide-pagination":"",loading:e.loading},{"body-cell-full_name":l(a=>[t(d,{props:a},{default:l(()=>[r("span",U,c(e.formatFullName(a.row.employer)),1)]),_:2},1032,["props"])]),"body-cell-applicant_full_name":l(a=>[t(d,{props:a},{default:l(()=>[r("span",E,c(e.formatFullName(a.row.applicant)),1)]),_:2},1032,["props"])]),"body-cell-action":l(a=>[t(d,{props:a},{default:l(()=>[t(s,{label:"Approve",color:"positive",onClick:A=>e.checkInterested(a.row,"approve"),class:"q-mr-sm"},null,8,["onClick"]),t(s,{label:"Reject",color:"negative",onClick:A=>e.checkInterested(a.row.id,"reject")},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading"])):v("",!0),t(b,{modelValue:e.dialogVisible,"onUpdate:modelValue":o[5]||(o[5]=a=>e.dialogVisible=a)},{default:l(()=>[t(h,null,{default:l(()=>[t(n,null,{default:l(()=>[k(" Are you sure you want to "+c(e.actionType)+" this hiring request? ",1)]),_:1}),t($,null,{default:l(()=>[t(s,{label:"Cancel",color:"secondary",onClick:o[4]||(o[4]=a=>e.dialogVisible=!1)}),t(s,{label:"Yes",color:"primary",onClick:e.proceedWithAction},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(b,{modelValue:e.interestedDialogVisible,"onUpdate:modelValue":o[6]||(o[6]=a=>e.interestedDialogVisible=a)},{default:l(()=>[t(h,null,{default:l(()=>[t(n,{class:"bg-red text-white"},{default:l(()=>[r("div",O,[t(V,{name:"warning",size:"md",class:"q-mr-sm"}),T])]),_:1}),t(n,null,{default:l(()=>[e.interestedEmployers.length?(i(),g("div",z,[(i(!0),g(H,null,_(e.interestedEmployers,a=>(i(),g("div",{key:a.id,class:"q-mb-md"},[r("p",null,[r("b",null,c(a.employer_name),1),k(" is also interested.")])]))),128)),t(s,{label:"Proceed",color:"primary",onClick:e.showConfirmationDialog},null,8,["onClick"])])):(i(),g("div",M,[W,t(s,{label:"Proceed",color:"primary",onClick:e.showConfirmationDialog},null,8,["onClick"])]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e.rejectedOrApproved?(i(),g("div",L,[t(j,{modelValue:e.pagination.page,"onUpdate:modelValue":[o[7]||(o[7]=a=>e.pagination.page=a),e.fetchApprovals],max:e.approvalMaxPages,color:"primary","boundary-numbers":"",class:"q-mt-md"},null,8,["modelValue","max","onUpdate:modelValue"]),t(C,{filled:"",modelValue:e.pagination.rowsPerPage,"onUpdate:modelValue":[o[8]||(o[8]=a=>e.pagination.rowsPerPage=a),e.fetchApprovals],options:e.rowsPerPageOptions,label:"Rows per page",class:"q-ml-sm",dense:"",style:{width:"200px"}},null,8,["modelValue","options","onUpdate:modelValue"])])):v("",!0),e.rejectedOrApproved?v("",!0):(i(),p(P,{key:2,square:"",class:"no-shadow q-mt-md",title:"Rejected Approvals",rows:e.hiredRows,columns:e.columns,"row-key":"id",pagination:e.pagination,"hide-pagination":"",loading:e.loading},{"body-cell-full_name":l(a=>[t(d,{props:a},{default:l(()=>[r("span",Y,c(e.formatFullName(a.row.employer)),1)]),_:2},1032,["props"])]),"body-cell-applicant_full_name":l(a=>[t(d,{props:a},{default:l(()=>[r("span",G,c(e.formatFullName(a.row.applicant)),1)]),_:2},1032,["props"])]),"body-cell-action":l(a=>[t(d,{props:a},{default:l(()=>[t(s,{label:"restore",color:"positive",onClick:A=>e.restoreHiring(a.row.id),class:"q-mr-sm"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading"])),e.rejectedOrApproved?v("",!0):(i(),g("div",J,[t(j,{modelValue:e.pagination.page,"onUpdate:modelValue":[o[9]||(o[9]=a=>e.pagination.page=a),e.fetchHired],max:e.hiredMaxPages,color:"primary","boundary-numbers":"",class:"q-mt-md"},null,8,["modelValue","max","onUpdate:modelValue"]),t(C,{filled:"",modelValue:e.pagination.rowsPerPage,"onUpdate:modelValue":[o[10]||(o[10]=a=>e.pagination.rowsPerPage=a),e.fetchHired],options:e.rowsPerPageOptions,label:"Rows per page",class:"q-ml-sm",dense:"",style:{width:"200px"}},null,8,["modelValue","options","onUpdate:modelValue"])]))]),_:1})]),_:1}),t(b,{modelValue:e.detailsDialog,"onUpdate:modelValue":o[12]||(o[12]=a=>e.detailsDialog=a)},{default:l(()=>[t(h,null,{default:l(()=>[t(n,null,{default:l(()=>[K]),_:1}),t(n),t($,{align:"right"},{default:l(()=>[t(s,{flat:"",label:"Close",onClick:o[11]||(o[11]=a=>e.detailsDialog=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Te=I(N,[["render",X],["__scopeId","data-v-49810729"]]);export{Te as default};
