import{Q as V}from"./QIcon.ea5b446d.js";import{Q as s}from"./QBtn.0cd3b6d8.js";import{Q as n}from"./QCardSection.716535fd.js";import{Q}from"./QSeparator.e84d2063.js";import{Q as P,a as d}from"./QTable.47344d01.js";import{Q as $}from"./QCardActions.3dff5dbd.js";import{Q as h}from"./QCard.b7e4e1a0.js";import{Q as b}from"./QDialog.4ef26000.js";import{Q as j}from"./QPagination.a2971530.js";import{Q as C}from"./QSelect.708c060d.js";import{Q as D}from"./QPage.2d416ccc.js";import{a as m}from"./axios.ab682c6b.js";import{_ as I,j as q,k as i,v as p,m as t,d as l,p as r,t as k,u as c,s as v,l as g,F as H,q as _,av as R,aw as F}from"./index.736ad444.js";import"./render.6912de76.js";import"./QSpinner.c748c914.js";import"./dom.1e4b93b2.js";import"./use-dark.e1720bdb.js";import"./QList.7895aa30.js";import"./QMarkupTable.b114800e.js";import"./scroll.fccc1b7a.js";import"./QCheckbox.6814ad40.js";import"./use-key-composition.9e2822db.js";import"./use-id.6ea4b0d3.js";import"./focus-manager.7cc6c8df.js";import"./use-prevent-scroll.a2c30d89.js";import"./use-timeout.5f9e01c3.js";import"./use-tick.a3aa914c.js";import"./use-portal.cabefa8e.js";import"./QInput.ed0871c6.js";import"./format.2cae61da.js";import"./QChip.81ee8217.js";import"./QItem.8d4a3ee9.js";import"./QItemLabel.49cb5c0e.js";import"./position-engine.d6b923eb.js";import"./selection.f6b17ade.js";import"./rtl.276c3f1b.js";const u="https://backend.parkease.online/api",N=q({name:"AdminHiring",data(){return{dialogVisible:!1,interestedDialogVisible:!1,actionType:"",interestedEmployers:[],approvalRows:[],hiredRows:[],socket:null,deleteDialog:!1,columns:[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"full_name",label:"Employer Full Name",align:"left",field:"full_name",sortable:!0},{name:"applicant_full_name",label:"Applicant Full Name",align:"left",field:"applicant_full_name",sortable:!0},{name:"profession",label:"Profession",align:"left",field:e=>e.applicant.resume?e.applicant.resume.profession:"N/A",sortable:!0},{name:"action",label:"Actions",align:"center",field:"action"}],pagination:{rowsPerPage:10,page:1},rowsPerPageOptions:[5,10],totalPages:0,approvalMaxPages:1,hiredMaxPages:1,selectedTransactionId:null,loading:!1,detailsDialog:!1,rejectedOrApproved:!0}},methods:{toggleForRejectedAndApproved(){this.rejectedOrApproved=!this.rejectedOrApproved},async fetchApprovals(){this.loading=!0;try{const e=localStorage.getItem("access_token"),{data:o}=await m.get(`${u}/display-hiring-approval`,{headers:{Authorization:`Bearer ${e}`},params:{page:this.pagination.page,perPage:this.pagination.rowsPerPage}});this.approvalRows=o.data,this.approvalMaxPages=o.last_page}catch(e){console.error("Error fetching approvals:",e)}finally{this.loading=!1}},async fetchHired(){this.loading=!0;try{const e=localStorage.getItem("access_token"),{data:o}=await m.get(`${u}/display-rejected`,{headers:{Authorization:`Bearer ${e}`},params:{page:this.pagination.page,perPage:this.pagination.rowsPerPage}});this.hiredRows=o.data,this.hiredMaxPages=o.last_page}catch(e){console.error("Error fetching hired applicants:",e)}finally{this.loading=!1}},checkInterested(e,o){this.$route.params.employerId;const y=localStorage.getItem("access_token");m.get(`${u}/check-interested/${e.applicant.id}/${e.employer.id}`,{headers:{Authorization:`Bearer ${y}`}}).then(f=>{f.data.status?(this.actionType=o,this.dialogVisible=!0):(this.interestedEmployers=f.data.interested_employers,this.interestedDialogVisible=!0),this.selectedTransactionId=e.id}).catch(f=>{console.error("Error checking interested employers:",f)})},showConfirmationDialog(){this.dialogVisible=!0,this.interestedDialogVisible=!1},proceedWithAction(){this.approveHiring(this.selectedTransactionId),this.dialogVisible=!1},async approveHiring(e){try{const o=localStorage.getItem("access_token");await m.put(`${u}/hire/${e}/approve`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error approving hire:",o)}},async restoreHiring(e){try{const o=localStorage.getItem("access_token");await m.put(`${u}/hire/${e}/restore`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error approving hire:",o)}},async rejectHiring(e){try{const o=localStorage.getItem("access_token");await m.put(`${u}/hire/${e}/rejected`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error rejecting hire:",o)}},formatFullName(e){return`${e.first_name} ${e.middle_name} ${e.last_name}`.trim()},openDetailsModal(e){this.detailsDialog=!0}},created(){const e="https://realtime.parkease.online";this.socket=io(e),this.socket.on("receiverTriggerness",(o,y)=>{o=="TriggerHiredApprovalPolling"&&(this.fetchApprovals(),this.fetchHired())})},mounted(){this.fetchApprovals(),this.fetchHired()}}),w=e=>(R("data-v-49810729"),e=e(),F(),e),B={class:"text-h6 margin-mobile-rr3"},S={style:{display:"flex","justify-content":"flex-end"}},U={class:"text-green-600 font-semibold"},E={class:"text-blue-600 font-semibold"},O={class:"row items-center"},T=w(()=>r("div",null,[r("h4",{class:"q-mb-sm"},"Warning"),r("p",null,"Note: Other employers are also interested. Would you like to reject them?")],-1)),z={key:0},M={key:1},W=w(()=>r("p",null,"No other employers are interested in this worker.",-1)),L={key:1,style:{display:"flex","justify-content":"space-between",padding:"10px"}},Y={class:"text-green-600 font-semibold"},G={class:"text-blue-600 font-semibold"},J={key:3,style:{display:"flex","justify-content":"space-between",padding:"10px"}},K=w(()=>r("div",{class:"text-h6"},"Applicant Details",-1));function X(e,o,y,f,Z,x){return i(),p(D,{padding:""},{default:t(()=>[l(h,{class:"no-shadow",bordered:""},{default:t(()=>[l(n,{class:"header-format-w header-mobile-res",style:{display:"flex","justify-content":"space-between"}},{default:t(()=>[r("div",B,[l(V,{name:"supervisor_account",size:"25px",class:"q-mr-sm"}),k(" Hiring Approval ")]),r("div",S,[e.rejectedOrApproved?(i(),p(s,{key:0,label:"Pending Approvals ",color:"white","text-color":"black",onClick:o[0]||(o[0]=a=>e.toggleForRejectedAndApproved()),class:"q-mr-sm"})):(i(),p(s,{key:1,label:"Pending Approvals ",color:"white","text-color":"white",onClick:o[1]||(o[1]=a=>e.toggleForRejectedAndApproved()),class:"q-mr-sm",flat:""})),e.rejectedOrApproved?(i(),p(s,{key:2,label:"Rejected Approvals",color:"white",onClick:o[2]||(o[2]=a=>e.toggleForRejectedAndApproved()),flat:""})):(i(),p(s,{key:3,label:"Rejected Approvals",color:"white","text-color":"black",onClick:o[3]||(o[3]=a=>e.toggleForRejectedAndApproved())}))])]),_:1}),l(Q),l(n,{class:"q-pa-none"},{default:t(()=>[e.rejectedOrApproved?(i(),p(P,{key:0,square:"",class:"no-shadow",title:"Pending Approvals",rows:e.approvalRows,columns:e.columns,"row-key":"id",pagination:e.pagination,"hide-pagination":"",loading:e.loading},{"body-cell-full_name":t(a=>[l(d,{props:a},{default:t(()=>[r("span",U,c(e.formatFullName(a.row.employer)),1)]),_:2},1032,["props"])]),"body-cell-applicant_full_name":t(a=>[l(d,{props:a},{default:t(()=>[r("span",E,c(e.formatFullName(a.row.applicant)),1)]),_:2},1032,["props"])]),"body-cell-action":t(a=>[l(d,{props:a},{default:t(()=>[l(s,{label:"Approve",color:"positive",onClick:A=>e.checkInterested(a.row,"approve"),class:"q-mr-sm"},null,8,["onClick"]),l(s,{label:"Reject",color:"negative",onClick:A=>e.checkInterested(a.row.id,"reject")},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading"])):v("",!0),l(b,{modelValue:e.dialogVisible,"onUpdate:modelValue":o[5]||(o[5]=a=>e.dialogVisible=a)},{default:t(()=>[l(h,null,{default:t(()=>[l(n,null,{default:t(()=>[k(" Are you sure you want to "+c(e.actionType)+" this hiring request? ",1)]),_:1}),l($,null,{default:t(()=>[l(s,{label:"Cancel",color:"secondary",onClick:o[4]||(o[4]=a=>e.dialogVisible=!1)}),l(s,{label:"Yes",color:"primary",onClick:e.proceedWithAction},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(b,{modelValue:e.interestedDialogVisible,"onUpdate:modelValue":o[6]||(o[6]=a=>e.interestedDialogVisible=a)},{default:t(()=>[l(h,null,{default:t(()=>[l(n,{class:"bg-red text-white"},{default:t(()=>[r("div",O,[l(V,{name:"warning",size:"md",class:"q-mr-sm"}),T])]),_:1}),l(n,null,{default:t(()=>[e.interestedEmployers.length?(i(),g("div",z,[(i(!0),g(H,null,_(e.interestedEmployers,a=>(i(),g("div",{key:a.id,class:"q-mb-md"},[r("p",null,[r("b",null,c(a.employer_name),1),k(" is also interested.")])]))),128)),l(s,{label:"Proceed",color:"primary",onClick:e.showConfirmationDialog},null,8,["onClick"])])):(i(),g("div",M,[W,l(s,{label:"Proceed",color:"primary",onClick:e.showConfirmationDialog},null,8,["onClick"])]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e.rejectedOrApproved?(i(),g("div",L,[l(j,{modelValue:e.pagination.page,"onUpdate:modelValue":[o[7]||(o[7]=a=>e.pagination.page=a),e.fetchApprovals],max:e.approvalMaxPages,color:"primary","boundary-numbers":"",class:"q-mt-md"},null,8,["modelValue","max","onUpdate:modelValue"]),l(C,{filled:"",modelValue:e.pagination.rowsPerPage,"onUpdate:modelValue":[o[8]||(o[8]=a=>e.pagination.rowsPerPage=a),e.fetchApprovals],options:e.rowsPerPageOptions,label:"Rows per page",class:"q-ml-sm",dense:"",style:{width:"200px"}},null,8,["modelValue","options","onUpdate:modelValue"])])):v("",!0),e.rejectedOrApproved?v("",!0):(i(),p(P,{key:2,square:"",class:"no-shadow q-mt-md",title:"Rejected Approvals",rows:e.hiredRows,columns:e.columns,"row-key":"id",pagination:e.pagination,"hide-pagination":"",loading:e.loading},{"body-cell-full_name":t(a=>[l(d,{props:a},{default:t(()=>[r("span",Y,c(e.formatFullName(a.row.employer)),1)]),_:2},1032,["props"])]),"body-cell-applicant_full_name":t(a=>[l(d,{props:a},{default:t(()=>[r("span",G,c(e.formatFullName(a.row.applicant)),1)]),_:2},1032,["props"])]),"body-cell-action":t(a=>[l(d,{props:a},{default:t(()=>[l(s,{label:"restore",color:"positive",onClick:A=>e.restoreHiring(a.row.id),class:"q-mr-sm"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading"])),e.rejectedOrApproved?v("",!0):(i(),g("div",J,[l(j,{modelValue:e.pagination.page,"onUpdate:modelValue":[o[9]||(o[9]=a=>e.pagination.page=a),e.fetchHired],max:e.hiredMaxPages,color:"primary","boundary-numbers":"",class:"q-mt-md"},null,8,["modelValue","max","onUpdate:modelValue"]),l(C,{filled:"",modelValue:e.pagination.rowsPerPage,"onUpdate:modelValue":[o[10]||(o[10]=a=>e.pagination.rowsPerPage=a),e.fetchHired],options:e.rowsPerPageOptions,label:"Rows per page",class:"q-ml-sm",dense:"",style:{width:"200px"}},null,8,["modelValue","options","onUpdate:modelValue"])]))]),_:1})]),_:1}),l(b,{modelValue:e.detailsDialog,"onUpdate:modelValue":o[12]||(o[12]=a=>e.detailsDialog=a)},{default:t(()=>[l(h,null,{default:t(()=>[l(n,null,{default:t(()=>[K]),_:1}),l(n),l($,{align:"right"},{default:t(()=>[l(s,{flat:"",label:"Close",onClick:o[11]||(o[11]=a=>e.detailsDialog=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ne=I(N,[["render",X],["__scopeId","data-v-49810729"]]);export{Ne as default};
