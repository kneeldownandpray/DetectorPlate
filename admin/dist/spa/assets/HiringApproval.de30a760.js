import{Q as A}from"./QIcon.6a1c506e.js";import{Q as s}from"./QBtn.ff85a6ff.js";import{Q as n}from"./QCardSection.d27bd26a.js";import{Q as C}from"./QSeparator.1b7512a0.js";import{Q as d}from"./QTd.5a66afdc.js";import{Q as V}from"./QTable.9d9784b4.js";import{Q as P}from"./QCardActions.c693319c.js";import{Q as f}from"./QCard.c79eb86a.js";import{Q as y}from"./QDialog.c9516741.js";import{Q as $}from"./QPagination.edf7b580.js";import{Q as j}from"./QSelect.71279283.js";import{Q}from"./QPage.cd4eeac7.js";import{_ as D,j as I,k as i,v as p,m as t,d as l,p as r,t as v,u as m,s as h,l as u,F as q,q as _,au as R,av as H}from"./index.ccc655a8.js";import"./use-size.e5fcccbb.js";import"./render.31dc14a1.js";import"./QSpinner.ad1652ab.js";import"./dom.ab32582f.js";import"./use-router-link.f3c58062.js";import"./vm.bd5b438f.js";import"./use-dark.fcf957f9.js";import"./QList.3fa3315d.js";import"./QMarkupTable.7a11d5f7.js";import"./scroll.3a45a3c7.js";import"./QCheckbox.5aa928a9.js";import"./private.use-form.bf143076.js";import"./use-prevent-scroll.89277a0f.js";import"./use-timeout.1142a48a.js";import"./use-tick.280905b1.js";import"./use-portal.887f479b.js";import"./focus-manager.7cc6c8df.js";import"./QInput.62618fbe.js";import"./use-key-composition.b73995f7.js";import"./use-id.51f80acb.js";import"./uid.937d8ee7.js";import"./format.2cae61da.js";import"./QChip.44a8527b.js";import"./QItem.79ca4c2d.js";import"./QItemLabel.c51f45b8.js";import"./position-engine.e628e528.js";import"./selection.1b9d0d65.js";import"./rtl.276c3f1b.js";const c="https://backend.parkease.online/api",F=I({name:"AdminHiring",data(){return{dialogVisible:!1,interestedDialogVisible:!1,actionType:"",interestedEmployers:[],approvalRows:[],hiredRows:[],socket:null,deleteDialog:!1,columns:[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"full_name",label:"Employer Full Name",align:"left",field:"full_name",sortable:!0},{name:"applicant_full_name",label:"Applicant Full Name",align:"left",field:"applicant_full_name",sortable:!0},{name:"profession",label:"Profession",align:"left",field:e=>e.applicant.resume?e.applicant.resume.profession:"N/A",sortable:!0},{name:"action",label:"Actions",align:"center",field:"action"}],pagination:{rowsPerPage:10,page:1},rowsPerPageOptions:[5,10],totalPages:0,approvalMaxPages:1,hiredMaxPages:1,selectedTransactionId:null,loading:!1,detailsDialog:!1,rejectedOrApproved:!0}},methods:{toggleForRejectedAndApproved(){this.rejectedOrApproved=!this.rejectedOrApproved},async fetchApprovals(){this.loading=!0;try{const e=localStorage.getItem("access_token"),{data:o}=await axios.get(`${c}/display-hiring-approval`,{headers:{Authorization:`Bearer ${e}`},params:{page:this.pagination.page,perPage:this.pagination.rowsPerPage}});this.approvalRows=o.data,this.approvalMaxPages=o.last_page}catch(e){console.error("Error fetching approvals:",e)}finally{this.loading=!1}},async fetchHired(){this.loading=!0;try{const e=localStorage.getItem("access_token"),{data:o}=await axios.get(`${c}/display-rejected`,{headers:{Authorization:`Bearer ${e}`},params:{page:this.pagination.page,perPage:this.pagination.rowsPerPage}});this.hiredRows=o.data,this.hiredMaxPages=o.last_page}catch(e){console.error("Error fetching hired applicants:",e)}finally{this.loading=!1}},checkInterested(e,o){this.$route.params.employerId;const w=localStorage.getItem("access_token");axios.get(`${c}/check-interested/${e.applicant.id}/${e.employer.id}`,{headers:{Authorization:`Bearer ${w}`}}).then(g=>{g.data.status?(this.actionType=o,this.dialogVisible=!0):(this.interestedEmployers=g.data.interested_employers,this.interestedDialogVisible=!0),this.selectedTransactionId=e.id}).catch(g=>{console.error("Error checking interested employers:",g)})},showConfirmationDialog(){this.dialogVisible=!0,this.interestedDialogVisible=!1},proceedWithAction(){this.approveHiring(this.selectedTransactionId),this.dialogVisible=!1},async approveHiring(e){try{const o=localStorage.getItem("access_token");await axios.put(`${c}/hire/${e}/approve`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error approving hire:",o)}},async restoreHiring(e){try{const o=localStorage.getItem("access_token");await axios.put(`${c}/hire/${e}/restore`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error approving hire:",o)}},async rejectHiring(e){try{const o=localStorage.getItem("access_token");await axios.put(`${c}/hire/${e}/rejected`,{},{headers:{Authorization:`Bearer ${o}`}}),this.fetchApprovals(),this.fetchHired()}catch(o){console.error("Error rejecting hire:",o)}},formatFullName(e){return`${e.first_name} ${e.middle_name} ${e.last_name}`.trim()},openDetailsModal(e){this.detailsDialog=!0}},created(){},mounted(){this.fetchApprovals(),this.fetchHired()}}),b=e=>(R("data-v-a75fa86a"),e=e(),H(),e),N={class:"text-h6 margin-mobile-rr3"},S={style:{display:"flex","justify-content":"flex-end"}},B={class:"text-green-600 font-semibold"},E={class:"text-blue-600 font-semibold"},U={class:"row items-center"},O=b(()=>r("div",null,[r("h4",{class:"q-mb-sm"},"Warning"),r("p",null,"Note: Other employers are also interested. Would you like to reject them?")],-1)),z={key:0},M={key:1},T=b(()=>r("p",null,"No other employers are interested in this worker.",-1)),W={key:1,style:{display:"flex","justify-content":"space-between",padding:"10px"}},L={class:"text-green-600 font-semibold"},Y={class:"text-blue-600 font-semibold"},G={key:3,style:{display:"flex","justify-content":"space-between",padding:"10px"}},J=b(()=>r("div",{class:"text-h6"},"Applicant Details",-1));function K(e,o,w,g,X,Z){return i(),p(Q,{padding:""},{default:t(()=>[l(f,{class:"no-shadow",bordered:""},{default:t(()=>[l(n,{class:"header-format-w header-mobile-res",style:{display:"flex","justify-content":"space-between"}},{default:t(()=>[r("div",N,[l(A,{name:"supervisor_account",size:"25px",class:"q-mr-sm"}),v(" Hiring Approval ")]),r("div",S,[e.rejectedOrApproved?(i(),p(s,{key:0,label:"Pending Approvals ",color:"white","text-color":"black",onClick:o[0]||(o[0]=a=>e.toggleForRejectedAndApproved()),class:"q-mr-sm"})):(i(),p(s,{key:1,label:"Pending Approvals ",color:"white","text-color":"white",onClick:o[1]||(o[1]=a=>e.toggleForRejectedAndApproved()),class:"q-mr-sm",flat:""})),e.rejectedOrApproved?(i(),p(s,{key:2,label:"Rejected Approvals",color:"white",onClick:o[2]||(o[2]=a=>e.toggleForRejectedAndApproved()),flat:""})):(i(),p(s,{key:3,label:"Rejected Approvals",color:"white","text-color":"black",onClick:o[3]||(o[3]=a=>e.toggleForRejectedAndApproved())}))])]),_:1}),l(C),l(n,{class:"q-pa-none"},{default:t(()=>[e.rejectedOrApproved?(i(),p(V,{key:0,square:"",class:"no-shadow",title:"Pending Approvals",rows:e.approvalRows,columns:e.columns,"row-key":"id",pagination:e.pagination,"hide-pagination":"",loading:e.loading},{"body-cell-full_name":t(a=>[l(d,{props:a},{default:t(()=>[r("span",B,m(e.formatFullName(a.row.employer)),1)]),_:2},1032,["props"])]),"body-cell-applicant_full_name":t(a=>[l(d,{props:a},{default:t(()=>[r("span",E,m(e.formatFullName(a.row.applicant)),1)]),_:2},1032,["props"])]),"body-cell-action":t(a=>[l(d,{props:a},{default:t(()=>[l(s,{label:"Approve",color:"positive",onClick:k=>e.checkInterested(a.row,"approve"),class:"q-mr-sm"},null,8,["onClick"]),l(s,{label:"Reject",color:"negative",onClick:k=>e.checkInterested(a.row.id,"reject")},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading"])):h("",!0),l(y,{modelValue:e.dialogVisible,"onUpdate:modelValue":o[5]||(o[5]=a=>e.dialogVisible=a)},{default:t(()=>[l(f,null,{default:t(()=>[l(n,null,{default:t(()=>[v(" Are you sure you want to "+m(e.actionType)+" this hiring request? ",1)]),_:1}),l(P,null,{default:t(()=>[l(s,{label:"Cancel",color:"secondary",onClick:o[4]||(o[4]=a=>e.dialogVisible=!1)}),l(s,{label:"Yes",color:"primary",onClick:e.proceedWithAction},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(y,{modelValue:e.interestedDialogVisible,"onUpdate:modelValue":o[6]||(o[6]=a=>e.interestedDialogVisible=a)},{default:t(()=>[l(f,null,{default:t(()=>[l(n,{class:"bg-red text-white"},{default:t(()=>[r("div",U,[l(A,{name:"warning",size:"md",class:"q-mr-sm"}),O])]),_:1}),l(n,null,{default:t(()=>[e.interestedEmployers.length?(i(),u("div",z,[(i(!0),u(q,null,_(e.interestedEmployers,a=>(i(),u("div",{key:a.id,class:"q-mb-md"},[r("p",null,[r("b",null,m(a.employer_name),1),v(" is also interested.")])]))),128)),l(s,{label:"Proceed",color:"primary",onClick:e.showConfirmationDialog},null,8,["onClick"])])):(i(),u("div",M,[T,l(s,{label:"Proceed",color:"primary",onClick:e.showConfirmationDialog},null,8,["onClick"])]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e.rejectedOrApproved?(i(),u("div",W,[l($,{modelValue:e.pagination.page,"onUpdate:modelValue":[o[7]||(o[7]=a=>e.pagination.page=a),e.fetchApprovals],max:e.approvalMaxPages,color:"primary","boundary-numbers":"",class:"q-mt-md"},null,8,["modelValue","max","onUpdate:modelValue"]),l(j,{filled:"",modelValue:e.pagination.rowsPerPage,"onUpdate:modelValue":[o[8]||(o[8]=a=>e.pagination.rowsPerPage=a),e.fetchApprovals],options:e.rowsPerPageOptions,label:"Rows per page",class:"q-ml-sm",dense:"",style:{width:"200px"}},null,8,["modelValue","options","onUpdate:modelValue"])])):h("",!0),e.rejectedOrApproved?h("",!0):(i(),p(V,{key:2,square:"",class:"no-shadow q-mt-md",title:"Rejected Approvals",rows:e.hiredRows,columns:e.columns,"row-key":"id",pagination:e.pagination,"hide-pagination":"",loading:e.loading},{"body-cell-full_name":t(a=>[l(d,{props:a},{default:t(()=>[r("span",L,m(e.formatFullName(a.row.employer)),1)]),_:2},1032,["props"])]),"body-cell-applicant_full_name":t(a=>[l(d,{props:a},{default:t(()=>[r("span",Y,m(e.formatFullName(a.row.applicant)),1)]),_:2},1032,["props"])]),"body-cell-action":t(a=>[l(d,{props:a},{default:t(()=>[l(s,{label:"restore",color:"positive",onClick:k=>e.restoreHiring(a.row.id),class:"q-mr-sm"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading"])),e.rejectedOrApproved?h("",!0):(i(),u("div",G,[l($,{modelValue:e.pagination.page,"onUpdate:modelValue":[o[9]||(o[9]=a=>e.pagination.page=a),e.fetchHired],max:e.hiredMaxPages,color:"primary","boundary-numbers":"",class:"q-mt-md"},null,8,["modelValue","max","onUpdate:modelValue"]),l(j,{filled:"",modelValue:e.pagination.rowsPerPage,"onUpdate:modelValue":[o[10]||(o[10]=a=>e.pagination.rowsPerPage=a),e.fetchHired],options:e.rowsPerPageOptions,label:"Rows per page",class:"q-ml-sm",dense:"",style:{width:"200px"}},null,8,["modelValue","options","onUpdate:modelValue"])]))]),_:1})]),_:1}),l(y,{modelValue:e.detailsDialog,"onUpdate:modelValue":o[12]||(o[12]=a=>e.detailsDialog=a)},{default:t(()=>[l(f,null,{default:t(()=>[l(n,null,{default:t(()=>[J]),_:1}),l(n),l(P,{align:"right"},{default:t(()=>[l(s,{flat:"",label:"Close",onClick:o[11]||(o[11]=a=>e.detailsDialog=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ue=D(F,[["render",K],["__scopeId","data-v-a75fa86a"]]);export{Ue as default};
